<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cost Segregation Analyzer | Creative Planning</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
    <!-- Include jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        body {
            font-family: 'Lato', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #FAFAFA;
            color: #555555;
        }

        .top-header {
            background-color: #003366;
            color: white;
            padding: 1rem 0;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-placeholder {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .header-nav {
            display: flex;
            gap: 2rem;
        }

        .header-nav a {
            color: white;
            text-decoration: none;
            font-weight: 400;
        }

        .hero-section {
            background-color: #E6F0F8;
            padding: 4rem 0;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #003366;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: #555555;
            margin-bottom: 2rem;
            text-align: center;
        }

        .hero-cta {
            background-color: #003366;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .hero-cta:hover {
            background-color: #002244;
        }

        .features-row {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .feature-item {
            background-color: white;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #003366;
            font-weight: 600;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section {
            background-color: #FFFFFF;
            border-radius: 6px;
            margin-bottom: 30px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #F0F0F0;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            color: #003366;
            font-size: 1.5rem;
            font-weight: 700;
            text-align: left;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #003366;
            font-size: 0.9rem;
            text-align: left;
        }

        input, select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #F0F0F0;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #003366;
        }

        .analyze-btn {
            background-color: #003366;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 30px;
            font-size: 1.1rem;
            transition: background-color 0.3s ease;
        }

        .analyze-btn:hover {
            background-color: #002244;
        }

        .voice-assistant-section {
            text-align: center;
            padding: 30px;
            background-color: #E6F0F8;
        }

        .voice-assistant-title {
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
            font-weight: 700;
            color: #003366;
        }

        .voice-assistant-subtitle {
            color: #555555;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .voice-widget-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px auto;
            padding: 10px;
        }

        elevenlabs-convai {
            width: 400px !important;
            height: 120px !important;
            min-width: 400px !important;
            min-height: 120px !important;
            max-width: 400px !important;
            max-height: 120px !important;
            display: block !important;
            margin: 0 auto !important;
            overflow: visible !important;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        elevenlabs-convai iframe {
            width: 100% !important;
            height: 100% !important;
            border: none !important;
            border-radius: 12px !important;
        }

        .results-section {
            display: none;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background-color: #003366;
            color: white;
            padding: 30px;
            border-radius: 6px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 51, 102, 0.2);
        }

        .result-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 15px 0;
        }

        .result-label {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            background-color: #F0F0F0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            background: none;
            border: none;
            font-weight: 600;
            color: #555555;
            transition: all 0.3s ease;
        }

        .tab.active {
            background-color: #003366;
            color: white;
        }

        .tab-content {
            display: none;
            padding: 20px;
            background-color: #FAFAFA;
            border-radius: 6px;
            border: 1px solid #F0F0F0;
        }

        .tab-content.active {
            display: block;
        }

        .scenarios-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .scenario-card {
            background-color: #FFFFFF;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #F0F0F0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .timeline-chart {
            margin-top: 20px;
        }

        .timeline-bar {
            height: 35px;
            background-color: #003366;
            margin-bottom: 10px;
            border-radius: 6px;
            position: relative;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            font-weight: 600;
        }

        .explanation-box {
            background-color: #E6F0F8;
            border-left: 4px solid #003366;
            padding: 20px;
            border-radius: 6px;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #555555;
        }

        .explanation-box h3, .explanation-box h4 {
            color: #003366;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .report-section {
            margin-top: 30px;
        }

        .download-buttons {
            margin-top: 30px;
            text-align: center;
        }

        .download-btn {
            background-color: #003366;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            margin: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }

        .download-btn:hover {
            background-color: #002244;
        }

        .disclaimer {
            background-color: #F0F0F0;
            border-left: 4px solid #003366;
            padding: 20px;
            margin-top: 30px;
            font-size: 0.9rem;
            color: #555555;
        }

        .disclaimer h4 {
            color: #003366;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .footer {
            background-color: #003366;
            color: white;
            padding: 40px 0;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h4 {
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section ul li {
            margin-bottom: 8px;
        }

        .footer-section ul li a {
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .footer-section ul li a:hover {
            opacity: 1;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 30px;
            padding-top: 20px;
            text-align: center;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        @media (max-width: 600px) {
            elevenlabs-convai {
                width: 350px !important;
                height: 120px !important;
            }
        }
    </style>
</head>
<body>
    <!-- Top Header -->
    <header class="top-header">
        <div class="header-content">
            <div class="logo-placeholder">Creative Planning</div>
            <nav class="header-nav">
                <a href="#services">Services</a>
                <a href="#about">About</a>
                <a href="#contact">Contact</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">Cost Segregation Analyzer</h1>
            <p class="hero-subtitle">Maximize your property tax savings with our comprehensive AI-powered analysis. Get professional insights and detailed reports to optimize your real estate investments.</p>
            <button class="hero-cta" onclick="document.querySelector('.main-content').scrollIntoView({behavior: 'smooth'})">Start Your Analysis</button>
            <div class="features-row">
                <div class="feature-item">
                    <span>🎯</span> AI-Powered Analysis
                </div>
                <div class="feature-item">
                    <span>📊</span> Visual Comparisons
                </div>
                <div class="feature-item">
                    <span>📋</span> Professional Reports
                </div>
            </div>
        </div>
    </section>

    <div class="main-content">
        <!-- Voice Assistant Section -->
        <div class="section voice-assistant-section">
            <div class="voice-assistant-title">🎙️ AI Voice Assistant</div>
            <div class="voice-assistant-subtitle">Ask questions about cost segregation, get guidance on your property analysis, or let the AI help you through the process.</div>
            <div class="voice-widget-container">
                <elevenlabs-convai agent-id="agent_01k0achpthfewtj7cytwye8b70"></elevenlabs-convai>
            </div>
            <script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>
        </div>

        <!-- Property Information Form -->
        <div class="section">
            <div class="section-header">📋 Property Information</div>
            <div class="form-grid">
                <div class="form-group">
                    <label for="propertyType">Property Type</label>
                    <select id="propertyType">
                        <option value="">Select Property Type</option>
                        <option value="Commercial Office Building">Commercial Office Building</option>
                        <option value="Retail Space">Retail Space</option>
                        <option value="Multifamily Residential">Multifamily Residential</option>
                        <option value="Warehouse">Warehouse</option>
                        <option value="Restaurant">Restaurant</option>
                        <option value="Hotel">Hotel</option>
                        <option value="Medical Office">Medical Office</option>
                        <option value="Manufacturing">Manufacturing Facility</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="purchasePrice">Total Purchase Price</label>
                    <input type="number" id="purchasePrice" placeholder="Enter purchase price">
                </div>

                <div class="form-group">
                    <label for="landValue">Land Value</label>
                    <input type="number" id="landValue" placeholder="Enter land value">
                </div>

                <div class="form-group">
                    <label for="yearInService">Year Placed in Service</label>
                    <select id="yearInService">
                        <option value="">Select Year</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                        <option value="2019">2019</option>
                        <option value="2018">2018</option>
                        <option value="2017">2017</option>
                        <option value="2016">2016</option>
                        <option value="2015">2015</option>
                        <option value="2014">2014</option>
                        <option value="2013">2013</option>
                        <option value="2012">2012</option>
                        <option value="2011">2011</option>
                        <option value="2010">2010</option>
                        <option value="2009">2009</option>
                        <option value="2008">2008</option>
                        <option value="2007">2007</option>
                        <option value="2006">2006</option>
                        <option value="2005">2005</option>
                        <option value="2004">2004</option>
                        <option value="2003">2003</option>
                        <option value="2002">2002</option>
                        <option value="2001">2001</option>
                        <option value="2000">2000</option>
                        <option value="1999">1999</option>
                        <option value="1998">1998</option>
                        <option value="1997">1997</option>
                        <option value="1996">1996</option>
                        <option value="1995">1995</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="propertyState">Property State</label>
                    <select id="propertyState">
                        <option value="">Select State</option>
                        <option value="AL">Alabama</option>
                        <option value="AK">Alaska</option>
                        <option value="AZ">Arizona</option>
                        <option value="AR">Arkansas</option>
                        <option value="CA">California</option>
                        <option value="CO">Colorado</option>
                        <option value="CT">Connecticut</option>
                        <option value="DE">Delaware</option>
                        <option value="FL">Florida</option>
                        <option value="GA">Georgia</option>
                        <option value="HI">Hawaii</option>
                        <option value="ID">Idaho</option>
                        <option value="IL">Illinois</option>
                        <option value="IN">Indiana</option>
                        <option value="IA">Iowa</option>
                        <option value="KS">Kansas</option>
                        <option value="KY">Kentucky</option>
                        <option value="LA">Louisiana</option>
                        <option value="ME">Maine</option>
                        <option value="MD">Maryland</option>
                        <option value="MA">Massachusetts</option>
                        <option value="MI">Michigan</option>
                        <option value="MN">Minnesota</option>
                        <option value="MS">Mississippi</option>
                        <option value="MO">Missouri</option>
                        <option value="MT">Montana</option>
                        <option value="NE">Nebraska</option>
                        <option value="NV">Nevada</option>
                        <option value="NH">New Hampshire</option>
                        <option value="NJ">New Jersey</option>
                        <option value="NM">New Mexico</option>
                        <option value="NY">New York</option>
                        <option value="NC">North Carolina</option>
                        <option value="ND">North Dakota</option>
                        <option value="OH">Ohio</option>
                        <option value="OK">Oklahoma</option>
                        <option value="OR">Oregon</option>
                        <option value="PA">Pennsylvania</option>
                        <option value="RI">Rhode Island</option>
                        <option value="SC">South Carolina</option>
                        <option value="SD">South Dakota</option>
                        <option value="TN">Tennessee</option>
                        <option value="TX">Texas</option>
                        <option value="UT">Utah</option>
                        <option value="VT">Vermont</option>
                        <option value="VA">Virginia</option>
                        <option value="WA">Washington</option>
                        <option value="WV">West Virginia</option>
                        <option value="WI">Wisconsin</option>
                        <option value="WY">Wyoming</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="squareFootage">Building Square Footage</label>
                    <input type="number" id="squareFootage" placeholder="Enter square footage">
                </div>

                <div class="form-group">
                    <label for="federalTaxRate">Federal Tax Rate (%)</label>
                    <select id="federalTaxRate">
                        <option value="">Select Tax Rate</option>
                        <option value="21">21% (Corporate)</option>
                        <option value="37">37% (Individual)</option>
                        <option value="35">35%</option>
                        <option value="32">32%</option>
                        <option value="24">24%</option>
                        <option value="22">22%</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="stateTaxRate">State Tax Rate (%)</label>
                    <input type="number" id="stateTaxRate" placeholder="Enter state tax rate" min="0" max="15" step="0.1">
                </div>
            </div>

            <button class="analyze-btn" onclick="analyzeProperty()">Analyze Property</button>
        </div>

        <!-- Understanding Cost Segregation Section -->
        <div class="section">
            <div class="section-header">📚 Understanding Cost Segregation</div>
            
            <div class="explanation-box">
                <h3>What is Cost Segregation?</h3>
                <p>Cost segregation is a tax strategy that separates the components of a building into different depreciation categories, allowing property owners to accelerate depreciation deductions and reduce current tax liability.</p>
                <p>Instead of depreciating the entire building over 27.5 years (residential) or 39 years (commercial), cost segregation identifies components that can be depreciated over 5, 7, or 15 years.</p>
            </div>
            
            <div class="explanation-box" style="margin-top: 15px;">
                <h3>Key Benefits</h3>
                <ul>
                    <li>Immediate tax savings through accelerated depreciation</li>
                    <li>Improved cash flow from reduced tax payments</li>
                    <li>100% bonus depreciation for eligible components</li>
                    <li>IRS-approved tax strategy with audit protection</li>
                </ul>
            </div>
            
            <div class="explanation-box" style="margin-top: 15px; border-left-color: #003366;">
                <h3>Bonus Depreciation Opportunity</h3>
                <p>The Tax Cuts and Jobs Act allows 100% bonus depreciation for qualified property placed in service from September 27, 2017, through December 31, 2022, and 80% for 2023. This means you can deduct the full cost of 5, 7, and 15-year property components in the first year!</p>
            </div>
        </div>

        <!-- Results Section (Initially Hidden) -->
        <div id="resultsSection" class="section results-section">
            <div class="section-header">📊 Cost Segregation Analysis Results</div>
            
            <div class="results-grid">
                <div class="result-card">
                    <div>Total Depreciable Basis</div>
                    <div class="result-value" id="depreciableBasis">$0</div>
                    <div class="result-label">Purchase Price - Land Value</div>
                </div>
                
                <div class="result-card">
                    <div>First-Year Accelerated Deduction</div>
                    <div class="result-value" id="firstYearDeduction">$0</div>
                    <div class="result-label">5/7-Year + 15-Year Components</div>
                </div>
                
                <div class="result-card">
                    <div>Estimated Tax Savings</div>
                    <div class="result-value" id="taxSavings">$0</div>
                    <div class="result-label">Federal + State Combined</div>
                </div>
            </div>

            <div class="explanation-box">
                <h3>Your Potential Tax Savings</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 15px;">
                    <div>
                        <strong>Year 1 Savings</strong><br>
                        <span id="year1Savings" style="font-size: 1.5rem; color: #003366;">$0</span>
                    </div>
                    <div>
                        <strong>5-Year Cumulative Savings</strong><br>
                        <span id="fiveYearSavings" style="font-size: 1.5rem; color: #003366;">$0</span>
                    </div>
                </div>
            </div>

            <!-- Property-Specific Analysis -->
            <div style="margin-top: 30px;">
                <div class="section-header">🏢 Property-Specific Analysis</div>
                
                <div class="tabs">
                    <button class="tab active" onclick="showTab('componentAnalysis', this)">Component Analysis</button>
                    <button class="tab" onclick="showTab('scenarios', this)">Scenarios</button>
                    <button class="tab" onclick="showTab('timeline', this)">Timeline</button>
                    <button class="tab" onclick="showTab('roiAnalysis', this)">ROI Analysis</button>
                </div>

                <div id="componentAnalysis" class="tab-content active">
                    <h3>Depreciation Component Breakdown</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                        <div class="scenario-card">
                            <strong>5/7-Year Property</strong>
                            <p id="fiveSevenYear" style="font-size: 1.5rem; color: #003366;">$0</p>
                            <small>Personal property, equipment</small>
                        </div>
                        <div class="scenario-card">
                            <strong>15-Year Property</strong>
                            <p id="fifteenYear" style="font-size: 1.5rem; color: #003366;">$0</p>
                            <small>Land improvements</small>
                        </div>
                        <div class="scenario-card">
                            <strong>39-Year Building</strong>
                            <p id="thirtyNineYear" style="font-size: 1.5rem; color: #003366;">$0</p>
                            <small>Building structure</small>
                        </div>
                    </div>
                </div>

                <div id="scenarios" class="tab-content">
                    <h3>Cost Segregation vs. Traditional Depreciation</h3>
                    <div class="scenarios-grid">
                        <div class="scenario-card">
                            <h4>Traditional Depreciation</h4>
                            <p>First Year Deduction: <span id="traditionalDeduction" style="color: #003366;">$0</span></p>
                            <p>Tax Savings: <span id="traditionalSavings" style="color: #003366;">$0</span></p>
                        </div>
                        <div class="scenario-card">
                            <h4>With Cost Segregation</h4>
                            <p>First Year Deduction: <span id="costSegDeduction" style="color: #003366;">$0</span></p>
                            <p>Tax Savings: <span id="costSegSavings" style="color: #003366;">$0</span></p>
                        </div>
                    </div>
                </div>

                <div id="timeline" class="tab-content">
                    <h3>5-Year Tax Savings Timeline</h3>
                    <div class="timeline-chart">
                        <div id="year1Bar" class="timeline-bar" style="width: 100%;">
                            <span>Year 1</span><span id="year1Amount">$0</span>
                        </div>
                        <div id="year2Bar" class="timeline-bar" style="width: 80%;">
                            <span>Year 2</span><span id="year2Amount">$0</span>
                        </div>
                        <div id="year3Bar" class="timeline-bar" style="width: 60%;">
                            <span>Year 3</span><span id="year3Amount">$0</span>
                        </div>
                        <div id="year4Bar" class="timeline-bar" style="width: 40%;">
                            <span>Year 4</span><span id="year4Amount">$0</span>
                        </div>
                        <div id="year5Bar" class="timeline-bar" style="width: 20%;">
                            <span>Year 5</span><span id="year5Amount">$0</span>
                        </div>
                    </div>
                </div>

                <div id="roiAnalysis" class="tab-content">
                    <h3>Return on Investment Analysis</h3>
                    <p style="margin-bottom: 20px; font-style: italic; color: #003366;">Enter your estimated study costs to see your overall investment return:</p>
                    
                    <div class="scenarios-grid">
                        <div class="scenario-card">
                            <h4>Scenario 1: Conservative Study</h4>
                            <div style="margin: 15px 0;">
                                <label for="studyCost1">Estimated Study Cost ($):</label>
                                <input type="number" id="studyCost1" placeholder="5000" onchange="calculateROI()">
                                <small>Note: Enter the estimated cost for a basic cost segregation study</small>
                            </div>
                            <div style="background-color: #E6F0F8; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                <p><strong>Overall Investment ROI:</strong> <span id="roi1">0.00%</span></p>
                                <p><strong>Payback Period:</strong> <span id="payback1">0.0 months</span></p>
                            </div>
                            <div style="background-color: #E6F0F8; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                <strong>Calculation Method:</strong><br>
                                ROI = Tax Savings ÷ (Purchase Price + Study Cost) × 100<br>
                                <span id="roiCalc1">$0 ÷ ($0 + $0) × 100 = 0.00%</span><br>
                                <em>This shows the tax savings as a percentage of your total property investment including study fees.</em>
                            </div>
                        </div>
                        
                        <div class="scenario-card">
                            <h4>Scenario 2: Comprehensive Study</h4>
                            <div style="margin: 15px 0;">
                                <label for="studyCost2">Estimated Study Cost ($):</label>
                                <input type="number" id="studyCost2" placeholder="8000" onchange="calculateROI()">
                                <small>Note: Enter the estimated cost for a comprehensive cost segregation study</small>
                            </div>
                            <div style="background-color: #E6F0F8; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                <p><strong>Overall Investment ROI:</strong> <span id="roi2">0.00%</span></p>
                                <p><strong>Payback Period:</strong> <span id="payback2">0.0 months</span></p>
                            </div>
                            <div style="background-color: #E6F0F8; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                <strong>Calculation Method:</strong><br>
                                ROI = Tax Savings ÷ (Purchase Price + Study Cost) × 100<br>
                                <span id="roiCalc2">$0 ÷ ($0 + $0) × 100 = 0.00%</span><br>
                                <em>This shows the tax savings as a percentage of your total property investment including study fees.</em>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Professional Report -->
            <div class="report-section">
                <div class="section-header">📋 Professional Report Summary</div>
                
                <div class="explanation-box">
                    <h3>Executive Summary</h3>
                    <p id="executiveSummary">Complete the property analysis to generate your executive summary.</p>
                </div>
                
                <div class="explanation-box" style="margin-top: 15px;">
                    <h3>Detailed Analysis</h3>
                    <div id="detailedAnalysis">
                        <p>Property analysis results will appear here after calculation.</p>
                    </div>
                </div>
                
                <div class="explanation-box" style="margin-top: 15px;">
                    <h3>Recommendations</h3>
                    <ul>
                        <li>Proceed with a formal cost segregation study to validate these preliminary findings</li>
                        <li>Consider timing the study to maximize current year tax benefits</li>
                        <li>Ensure proper documentation is maintained for IRS compliance</li>
                        <li>Review state tax implications and potential additional benefits</li>
                    </ul>
                </div>

                <div class="download-buttons">
                    <button class="download-btn" onclick="generateExecutiveSummaryPDF()">Download Executive Summary PDF</button>
                    <button class="download-btn" onclick="generateFullReportPDF()">Download Complete Analysis PDF</button>
                </div>
            </div>

            <!-- Disclaimer -->
            <div class="disclaimer">
                <h4>Important Disclaimer</h4>
                <p>This analysis is based on general assumptions and industry averages. A formal cost segregation study by a qualified professional is required for actual tax filings. Results may vary based on specific property conditions and tax circumstances. Creative Planning recommends consulting with a tax professional before making any tax-related decisions.</p>
            </div>
        </div>

        <!-- Next Steps & Resources -->
        <div class="section">
            <div class="section-header">📝 Next Steps & Resources</div>
            
            <div class="scenarios-grid">
                <div class="scenario-card">
                    <h4>Immediate Actions</h4>
                    <ul>
                        <li>Share this analysis with your CPA or tax advisor</li>
                        <li>Request a formal cost segregation study proposal</li>
                        <li>Gather construction documents and invoices</li>
                        <li>Consider timing for maximum tax benefit</li>
                    </ul>
                </div>
                
                <div class="scenario-card">
                    <h4>Study Requirements</h4>
                    <ul>
                        <li>Property purchase agreements</li>
                        <li>Construction contracts and invoices</li>
                        <li>Architectural plans and specifications</li>
                        <li>Property appraisals</li>
                    </ul>
                </div>
            </div>
            
            <div class="explanation-box" style="margin-top: 20px;">
                <h3>Pro Tip</h3>
                <p>Cost segregation studies typically pay for themselves 10-100 times over in tax savings. The earlier you complete the study after property acquisition, the greater the benefit due to time value of money.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Services</h4>
                <ul>
                    <li><a href="#">Cost Segregation</a></li>
                    <li><a href="#">Tax Planning</a></li>
                    <li><a href="#">Investment Analysis</a></li>
                    <li><a href="#">Financial Consulting</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <ul>
                    <li><a href="#">Tax Calculator</a></li>
                    <li><a href="#">Planning Guides</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Webinars</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Company</h4>
                <ul>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Our Team</a></li>
                    <li><a href="#">Careers</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Legal</h4>
                <ul>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="#">Disclaimer</a></li>
                    <li><a href="#">Compliance</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Creative Planning. All rights reserved. | Licensed financial advisors providing comprehensive wealth management services.</p>
        </div>
    </footer>

    <script>
        // jsPDF initialization
        window.jsPDF = window.jspdf.jsPDF;

        let calculationResults = {};

        function analyzeProperty() {
            // Get form values
            const propertyType = document.getElementById('propertyType').value;
            const purchasePrice = parseFloat(document.getElementById('purchasePrice').value) || 0;
            const landValue = parseFloat(document.getElementById('landValue').value) || 0;
            const yearInService = parseInt(document.getElementById('yearInService').value) || 0;
            const propertyState = document.getElementById('propertyState').value;
            const squareFootage = parseFloat(document.getElementById('squareFootage').value) || 0;
            const federalTaxRate = parseFloat(document.getElementById('federalTaxRate').value) || 0;
            const stateTaxRate = parseFloat(document.getElementById('stateTaxRate').value) || 0;

            // Validate inputs
            if (!propertyType || purchasePrice <= 0 || landValue < 0 || yearInService === 0 || 
                !propertyState || squareFootage <= 0 || federalTaxRate === 0) {
                alert('Please fill in all required fields with valid values.');
                return;
            }

            if (landValue >= purchasePrice) {
                alert('Land value must be less than the total purchase price.');
                return;
            }

            // Calculate depreciable basis
            const depreciableBasis = purchasePrice - landValue;

            // Calculate component allocations
            const fiveSevenYear = depreciableBasis * 0.20;  // 20%
            const fifteenYear = depreciableBasis * 0.10;    // 10%
            const thirtyNineYear = depreciableBasis * 0.70; // 70%

            // Calculate first year deduction
            let firstYearDeduction = 0;
            let bonusDepreciation = false;
            
            if (yearInService >= 2017 && yearInService <= 2022) {
                // 100% bonus depreciation
                firstYearDeduction = fiveSevenYear + fifteenYear;
                bonusDepreciation = true;
            } else if (yearInService === 2023) {
                // 80% bonus depreciation
                firstYearDeduction = (fiveSevenYear + fifteenYear) * 0.80;
                bonusDepreciation = true;
            } else {
                // Standard depreciation
                firstYearDeduction = (fiveSevenYear / 7) + (fifteenYear / 15) + (thirtyNineYear / 39);
            }

            // Calculate tax savings
            const federalSavings = firstYearDeduction * (federalTaxRate / 100);
            const stateSavings = firstYearDeduction * (stateTaxRate / 100);
            const totalTaxSavings = federalSavings + stateSavings;

            // Calculate 5-year projections
            const fiveYearSavings = totalTaxSavings * 1.5; // Simplified projection

            // Traditional depreciation comparison
            const traditionalFirstYear = depreciableBasis / (propertyType.includes('Residential') ? 27.5 : 39);
            const traditionalSavings = traditionalFirstYear * ((federalTaxRate + stateTaxRate) / 100);

            // Store results
            calculationResults = {
                depreciableBasis,
                fiveSevenYear,
                fifteenYear,
                thirtyNineYear,
                firstYearDeduction,
                totalTaxSavings,
                fiveYearSavings,
                traditionalFirstYear,
                traditionalSavings,
                propertyType,
                propertyState,
                purchasePrice,
                landValue,
                yearInService,
                squareFootage,
                federalTaxRate,
                stateTaxRate,
                bonusDepreciation
            };

            // Display results
            displayResults();
        }

        function displayResults() {
            const r = calculationResults;

            // Update main results
            document.getElementById('depreciableBasis').textContent = formatCurrency(r.depreciableBasis);
            document.getElementById('firstYearDeduction').textContent = formatCurrency(r.firstYearDeduction);
            document.getElementById('taxSavings').textContent = formatCurrency(r.totalTaxSavings);
            document.getElementById('year1Savings').textContent = formatCurrency(r.totalTaxSavings);
            document.getElementById('fiveYearSavings').textContent = formatCurrency(r.fiveYearSavings);

            // Component breakdown
            document.getElementById('fiveSevenYear').textContent = formatCurrency(r.fiveSevenYear);
            document.getElementById('fifteenYear').textContent = formatCurrency(r.fifteenYear);
            document.getElementById('thirtyNineYear').textContent = formatCurrency(r.thirtyNineYear);

            // Scenario comparison
            document.getElementById('traditionalDeduction').textContent = formatCurrency(r.traditionalFirstYear);
            document.getElementById('traditionalSavings').textContent = formatCurrency(r.traditionalSavings);
            document.getElementById('costSegDeduction').textContent = formatCurrency(r.firstYearDeduction);
            document.getElementById('costSegSavings').textContent = formatCurrency(r.totalTaxSavings);

            // Timeline chart
            document.getElementById('year1Amount').textContent = formatCurrency(r.totalTaxSavings);
            document.getElementById('year2Amount').textContent = formatCurrency(r.totalTaxSavings * 0.5);
            document.getElementById('year3Amount').textContent = formatCurrency(r.totalTaxSavings * 0.4);
            document.getElementById('year4Amount').textContent = formatCurrency(r.totalTaxSavings * 0.3);
            document.getElementById('year5Amount').textContent = formatCurrency(r.totalTaxSavings * 0.3);
            
            // Adjust bar widths
            const maxSavings = r.totalTaxSavings;
            document.getElementById('year1Bar').style.width = '100%';
            document.getElementById('year2Bar').style.width = (r.totalTaxSavings * 0.5) / maxSavings * 100 + '%';
            document.getElementById('year3Bar').style.width = (r.totalTaxSavings * 0.4) / maxSavings * 100 + '%';
            document.getElementById('year4Bar').style.width = (r.totalTaxSavings * 0.3) / maxSavings * 100 + '%';
            document.getElementById('year5Bar').style.width = (r.totalTaxSavings * 0.3) / maxSavings * 100 + '%';

            // Generate executive summary
            const bonusText = r.bonusDepreciation ? 
                `with ${r.yearInService === 2023 ? '80%' : '100%'} bonus depreciation benefits` : 
                "using standard depreciation";
            
            const taxSavingsPercent = (r.totalTaxSavings / r.purchasePrice * 100).toFixed(1);
            
            let propertyDescription;
            if (r.squareFootage < 10000) {
                propertyDescription = "smaller";
            } else if (r.squareFootage >= 10000 && r.squareFootage < 50000) {
                propertyDescription = "mid-sized";
            } else {
                propertyDescription = "large";
            }
            
            const executiveSummary = `
                Based on our analysis of your ${propertyDescription} ${r.propertyType.toLowerCase()} property in ${r.propertyState}, 
                with a purchase price of ${formatCurrency(r.purchasePrice)} and land value of ${formatCurrency(r.landValue)}, 
                you may be eligible for ${formatCurrency(r.firstYearDeduction)} in accelerated depreciation in year one ${bonusText}. 
                
                This represents a significant opportunity to reduce your tax liability by approximately ${formatCurrency(r.totalTaxSavings)} 
                (${taxSavingsPercent}% of your property value) in the first year alone, with projected 5-year cumulative tax savings of 
                ${formatCurrency(r.fiveYearSavings)}.
                
                Compared to traditional depreciation methods, cost segregation provides a ${(r.firstYearDeduction / r.traditionalFirstYear).toFixed(1)}x 
                increase in first-year deductions, substantially improving your cash flow and return on investment.
            `;
            
            document.getElementById('executiveSummary').innerHTML = executiveSummary;

            // Generate detailed analysis
            const detailedAnalysis = `
                <p><strong>Property Details:</strong></p>
                <ul>
                    <li>Property Type: ${r.propertyType}</li>
                    <li>Purchase Price: ${formatCurrency(r.purchasePrice)}</li>
                    <li>Land Value: ${formatCurrency(r.landValue)}</li>
                    <li>Depreciable Basis: ${formatCurrency(r.depreciableBasis)}</li>
                    <li>Year Placed in Service: ${r.yearInService}</li>
                    <li>Building Square Footage: ${r.squareFootage.toLocaleString()}</li>
                </ul>
                <p><strong>Component Allocation:</strong></p>
                <ul>
                    <li>5/7-Year Property: ${formatCurrency(r.fiveSevenYear)} (20% of basis)</li>
                    <li>15-Year Property: ${formatCurrency(r.fifteenYear)} (10% of basis)</li>
                    <li>39-Year Building: ${formatCurrency(r.thirtyNineYear)} (70% of basis)</li>
                </ul>
                <p><strong>Tax Analysis:</strong></p>
                <ul>
                    <li>Federal Tax Rate: ${r.federalTaxRate}%</li>
                    <li>State Tax Rate: ${r.stateTaxRate}%</li>
                    <li>First-Year Deduction: ${formatCurrency(r.firstYearDeduction)}</li>
                    <li>First-Year Tax Savings: ${formatCurrency(r.totalTaxSavings)}</li>
                    <li>5-Year Projected Savings: ${formatCurrency(r.fiveYearSavings)}</li>
                </ul>
            `;
            
            document.getElementById('detailedAnalysis').innerHTML = detailedAnalysis;

            // Calculate ROI if study costs are entered
            calculateROI();

            // Show results section
            document.getElementById('resultsSection').style.display = 'block';
            
            // Scroll to results
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function calculateROI() {
            if (!calculationResults.totalTaxSavings) return;

            const studyCost1 = parseFloat(document.getElementById('studyCost1').value) || 0;
            const studyCost2 = parseFloat(document.getElementById('studyCost2').value) || 0;
            const taxSavings = calculationResults.totalTaxSavings;
            const purchasePrice = calculationResults.purchasePrice;

            // Corrected ROI calculation for overall investment including study fees
            if (studyCost1 > 0) {
                const totalInvestment1 = purchasePrice + studyCost1;
                const roi1 = (taxSavings / totalInvestment1) * 100;
                const payback1 = (studyCost1 / (taxSavings / 12));
                
                document.getElementById('roi1').textContent = roi1.toFixed(2) + '%';
                document.getElementById('payback1').textContent = payback1.toFixed(1) + ' months';
                document.getElementById('roiCalc1').textContent = 
                    `${formatCurrency(taxSavings)} ÷ (${formatCurrency(purchasePrice)} + ${formatCurrency(studyCost1)}) × 100 = ${roi1.toFixed(2)}%`;
            }

            if (studyCost2 > 0) {
                const totalInvestment2 = purchasePrice + studyCost2;
                const roi2 = (taxSavings / totalInvestment2) * 100;
                const payback2 = (studyCost2 / (taxSavings / 12));
                
                document.getElementById('roi2').textContent = roi2.toFixed(2) + '%';
                document.getElementById('payback2').textContent = payback2.toFixed(1) + ' months';
                document.getElementById('roiCalc2').textContent = 
                    `${formatCurrency(taxSavings)} ÷ (${formatCurrency(purchasePrice)} + ${formatCurrency(studyCost2)}) × 100 = ${roi2.toFixed(2)}%`;
            }
        }

        function showTab(tabName, tabElement) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            tabElement.classList.add('active');
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function generateExecutiveSummaryPDF() {
            if (!calculationResults.propertyType) {
                alert('Please analyze a property first.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add Creative Planning header
            doc.setFillColor(0, 51, 102);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18);
            doc.text('Creative Planning', 20, 15);
            doc.setFontSize(12);
            doc.text('Cost Segregation Analysis', 20, 25);
            
            // Reset text color
            doc.setTextColor(0, 0, 0);
            
            // Add title
            doc.setFontSize(16);
            doc.text('Executive Summary', 105, 45, { align: 'center' });
            
            // Add property details
            doc.setFontSize(12);
            doc.text(`Property Type: ${calculationResults.propertyType}`, 20, 60);
            doc.text(`Location: ${calculationResults.propertyState}`, 20, 70);
            doc.text(`Purchase Price: ${formatCurrency(calculationResults.purchasePrice)}`, 20, 80);
            doc.text(`Year Placed in Service: ${calculationResults.yearInService}`, 20, 90);
            
            // Add results summary
            doc.setFillColor(240, 240, 240);
            doc.rect(20, 105, 170, 80, 'F');
            
            doc.setFontSize(14);
            doc.text('Analysis Results', 20, 120);
            
            doc.setFontSize(12);
            doc.text(`Depreciable Basis: ${formatCurrency(calculationResults.depreciableBasis)}`, 30, 135);
            doc.text(`First-Year Accelerated Deduction: ${formatCurrency(calculationResults.firstYearDeduction)}`, 30, 145);
            doc.text(`Estimated Tax Savings: ${formatCurrency(calculationResults.totalTaxSavings)}`, 30, 155);
            doc.text(`5-Year Projected Savings: ${formatCurrency(calculationResults.fiveYearSavings)}`, 30, 165);
            
            // Add executive summary
            doc.setFontSize(14);
            doc.text('Summary', 20, 200);
            
            const bonusText = calculationResults.bonusDepreciation ? 
                `with ${calculationResults.yearInService === 2023 ? '80%' : '100%'} bonus depreciation` : 
                "using standard depreciation";
                
            const summary = `For your ${calculationResults.propertyType} in ${calculationResults.propertyState}, 
you may be eligible for ${formatCurrency(calculationResults.firstYearDeduction)} in accelerated 
depreciation in year one ${bonusText}, resulting in tax savings of 
approximately ${formatCurrency(calculationResults.totalTaxSavings)}.`;
            
            doc.setFontSize(11);
            const splitSummary = doc.splitTextToSize(summary, 170);
            doc.text(splitSummary, 20, 210);
            
            // Add footer
            doc.setFillColor(0, 51, 102);
            doc.rect(0, 270, 210, 25, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(10);
            doc.text('Creative Planning | www.creativeplanning.com', 105, 280, { align: 'center' });
            doc.text('This analysis is for informational purposes only and not tax advice.', 105, 286, { align: 'center' });
            
            // Save PDF
            doc.save(`Cost_Segregation_Summary_${calculationResults.propertyType.replace(/\s+/g, '_')}.pdf`);
        }

        function generateFullReportPDF() {
            if (!calculationResults.propertyType) {
                alert('Please analyze a property first.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add Creative Planning header
            doc.setFillColor(0, 51, 102);
            doc.rect(0, 0, 210, 30, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(18);
            doc.text('Creative Planning', 20, 15);
            doc.setFontSize(12);
            doc.text('Cost Segregation Comprehensive Analysis', 20, 25);
            
            // Reset text color
            doc.setTextColor(0, 0, 0);
            
            // Add title
            doc.setFontSize(16);
            doc.text('Comprehensive Cost Segregation Analysis', 105, 45, { align: 'center' });
            
            // Add property details
            doc.setFontSize(14);
            doc.text('Property Information', 20, 60);
            
            doc.setFontSize(12);
            doc.text(`Property Type: ${calculationResults.propertyType}`, 30, 70);
            doc.text(`Location: ${calculationResults.propertyState}`, 30, 80);
            doc.text(`Purchase Price: ${formatCurrency(calculationResults.purchasePrice)}`, 30, 90);
            doc.text(`Land Value: ${formatCurrency(calculationResults.landValue)}`, 30, 100);
            doc.text(`Depreciable Basis: ${formatCurrency(calculationResults.depreciableBasis)}`, 30, 110);
            doc.text(`Year Placed in Service: ${calculationResults.yearInService}`, 30, 120);
            doc.text(`Building Square Footage: ${calculationResults.squareFootage.toLocaleString()}`, 30, 130);
            
            // Add component breakdown
            doc.setFontSize(14);
            doc.text('Component Breakdown', 20, 150);
            
            // Component breakdown table
            const componentData = [
                ['Component', 'Amount', 'Percentage'],
                ['5/7-Year Property', formatCurrency(calculationResults.fiveSevenYear), '20%'],
                ['15-Year Property', formatCurrency(calculationResults.fifteenYear), '10%'],
                ['39-Year Property', formatCurrency(calculationResults.thirtyNineYear), '70%'],
                ['Total', formatCurrency(calculationResults.depreciableBasis), '100%']
            ];
            
            doc.autoTable({
                startY: 155,
                head: [componentData[0]],
                body: componentData.slice(1),
                theme: 'grid',
                headStyles: { fillColor: [0, 51, 102] },
                styles: { cellPadding: 5 }
            });
            
            // Add tax analysis
            doc.setFontSize(14);
            doc.text('Tax Analysis', 20, doc.lastAutoTable.finalY + 20);
            
            // Tax analysis table
            const taxData = [
                ['Item', 'Traditional Depreciation', 'Cost Segregation'],
                ['First Year Deduction', formatCurrency(calculationResults.traditionalFirstYear), formatCurrency(calculationResults.firstYearDeduction)],
                ['Tax Savings (Year 1)', formatCurrency(calculationResults.traditionalSavings), formatCurrency(calculationResults.totalTaxSavings)],
                ['5-Year Projection', formatCurrency(calculationResults.traditionalSavings * 5), formatCurrency(calculationResults.fiveYearSavings)]
            ];
            
            doc.autoTable({
                startY: doc.lastAutoTable.finalY + 25,
                head: [taxData[0]],
                body: taxData.slice(1),
                theme: 'grid',
                headStyles: { fillColor: [0, 51, 102] },
                styles: { cellPadding: 5 }
            });
            
            // Add ROI analysis on new page
            doc.addPage();
            
            doc.setFillColor(0, 51, 102);
            doc.rect(0, 0, 210, 20, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(14);
            doc.text('Creative Planning | Cost Segregation Analysis', 105, 15, { align: 'center' });
            
            // Reset text color
            doc.setTextColor(0, 0, 0);
            
            doc.setFontSize(14);
            doc.text('Return on Investment Analysis', 20, 40);
            
            // Get study costs
            const studyCost1 = parseFloat(document.getElementById('studyCost1').value) || 5000;
            const studyCost2 = parseFloat(document.getElementById('studyCost2').value) || 8000;
            
            // Calculate ROIs
            const totalInvestment1 = calculationResults.purchasePrice + studyCost1;
            const roi1 = (calculationResults.totalTaxSavings / totalInvestment1) * 100;
            const payback1 = (studyCost1 / (calculationResults.totalTaxSavings / 12));
            
            const totalInvestment2 = calculationResults.purchasePrice + studyCost2;
            const roi2 = (calculationResults.totalTaxSavings / totalInvestment2) * 100;
            const payback2 = (studyCost2 / (calculationResults.totalTaxSavings / 12));
            
            // ROI analysis table
            const roiData = [
                ['Scenario', 'Study Cost', 'Overall Investment ROI', 'Payback Period'],
                ['Conservative Study', formatCurrency(studyCost1), roi1.toFixed(2) + '%', payback1.toFixed(1) + ' months'],
                ['Comprehensive Study', formatCurrency(studyCost2), roi2.toFixed(2) + '%', payback2.toFixed(1) + ' months']
            ];
            
            doc.autoTable({
                startY: 45,
                head: [roiData[0]],
                body: roiData.slice(1),
                theme: 'grid',
                headStyles: { fillColor: [0, 51, 102] },
                styles: { cellPadding: 5 }
            });
            
            // Add methodology explanation
            doc.setFontSize(14);
            doc.text('Methodology & Assumptions', 20, doc.lastAutoTable.finalY + 20);
            
            doc.setFontSize(11);
            const methodology = `This analysis uses industry-standard allocations for building components based on your property type:
- 20% of the depreciable basis is allocated to 5/7-year property (personal property)
- 10% of the depreciable basis is allocated to 15-year property (land improvements)
- 70% of the depreciable basis is allocated to 39-year property (building structure)

For properties placed in service from 2017-2022, 100% bonus depreciation is applied to 5/7-year and 15-year property.
For properties placed in service in 2023, 80% bonus depreciation is applied.`;
            
            const splitMethodology = doc.splitTextToSize(methodology, 170);
            doc.text(splitMethodology, 20, doc.lastAutoTable.finalY + 30);
            
            // Add recommendations
            doc.setFontSize(14);
            doc.text('Recommendations', 20, doc.lastAutoTable.finalY + 80);
            
            doc.setFontSize(11);
            const recommendations = `Based on this preliminary analysis, we recommend:
1. Proceeding with a formal cost segregation study to validate and potentially enhance these findings
2. Consulting with your tax advisor to coordinate the study with your overall tax strategy
3. Ensuring proper documentation is gathered to support the study findings
4. Considering the timing of the study to maximize current year tax benefits`;
            
            const splitRecommendations = doc.splitTextToSize(recommendations, 170);
            doc.text(splitRecommendations, 20, doc.lastAutoTable.finalY + 90);
            
            // Add disclaimer
            doc.setFillColor(245, 245, 245);
            doc.rect(20, doc.lastAutoTable.finalY + 120, 170, 40, 'F');
            
            doc.setFontSize(11);
            const disclaimer = 'IMPORTANT: This analysis is based on general assumptions and industry averages. A formal cost segregation study by a qualified professional is required for actual tax filings. Results may vary based on specific property conditions and tax circumstances.';
            
            const splitDisclaimer = doc.splitTextToSize(disclaimer, 160);
            doc.text(splitDisclaimer, 25, doc.lastAutoTable.finalY + 130);
            
            // Add footer
            doc.setFillColor(0, 51, 102);
            doc.rect(0, 270, 210, 25, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(10);
            doc.text('Creative Planning | www.creativeplanning.com', 105, 280, { align: 'center' });
            doc.text('This analysis is for informational purposes only and not tax advice.', 105, 286, { align: 'center' });
            
            // Save PDF
            doc.save(`Cost_Segregation_Full_Report_${calculationResults.propertyType.replace(/\s+/g, '_')}.pdf`);
        }
    </script>
</body>
</html>
